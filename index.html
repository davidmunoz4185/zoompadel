<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <title>Zoom Pádel WPT</title>
  <link rel="stylesheet" href="./css/bootstrap.min.css">
  <link rel="stylesheet" href="./css/keen-dashboards.css">
  <link rel="stylesheet" href="./css/dc.css">
  <link rel="stylesheet" href="./css/custom.css">
</head>
<body >

  <header class="text-center" id="header">
    <h1>WPT- Resumen Temporada 2015 - Torneos</h1>
  </header>

  <div class="container-fluid text-center">

    <div class="row">
      <div class="col-sm-4">
        <div class="row text-center">
          <div class="col-sm-4" id="topNumbers">
            <h7>
              4 Tipos de Torneo
            </h7>
          </div>
          <div class="col-sm-4" id="topNumbers">
            <h7>
              20 Torneos
            </h7>
          </div>
          <div class="col-sm-4" id="topNumbers">
            <h7>
              31 Torneos
            </h7>
          </div>
        </div>
        <div class="row">
          <div class="col-sm-12 text-center" id="titleChart">
              <h7>
                Porcentaje y Nº de Torneos por Tipo de Torneo
              </h7>
            <hr>
          </div>
        </div>
        <div class="row" id="rowCharts">
          <div class="col-sm-6" id="pieChart">
            <!--Chart 1.1 -->
          </div>
          <div class="col-sm-6" id="rowChart">
            <!--Chart 1.2 -->
          </div>
        </div>
        <div class="row">
          <div class="col-sm-9 text-left">
            Nº de Torneos por tipo de Torneo y Género
          </div>
          <div class="col-sm-3">
            Chart 1.3
          </div>
        </div>
        <div class="row">
          <div class="col-sm-12">
            <hr>
          </div>
        </div>
        <div class="row">
          <div class="col-sm-12">
            Chart 1.4
          </div>
        </div>
      </div>

      <div class="col-sm-4">
        <div class="row">
          <div class="col-sm-12" id="topNumbers">
            1.797 Partidos
          </div>
        </div>
        <div class="row">
          <div class="col-sm-12 text-center" id="titleChart">
            Porcentaje y Nº de Partidos por Tipo de Torneo
            <hr>
          </div>
        </div>
        <div class="row" id="rowCharts">
          <div class="col-sm-6" id="pieChart2">
            <!--Chart 2.1 -->
          </div>
          <div class="col-sm-6" id="rowChart2">
            <!--Chart 2.2 -->
          </div>
        </div>
        <div class="row">
          <div class="col-sm-9 text-left">
            Nº de Partidos por tipo de Torneo y Género
          </div>
          <div class="col-sm-3">
            Chart 2.3
          </div>
        </div>
        <div class="row">
          <div class="col-sm-12">
            <hr>
          </div>
        </div>
        <div class="row">
          <div class="col-sm-12">
            Chart 2.4
          </div>
        </div>
      </div>

      <div class="col-sm-4">
        <div class="row text-center">
          <div class="col-sm-12" id="topNumbers">
            Ratio Partidos / Torneo
          </div>
        </div>
        <div class="row">
          <div class="col-sm-12 text-center" id="titleChart">
            58 Partidos por Torneo
            <hr>
          </div>
        </div>
        <div class="row" id="rowCharts">
          <div class="col-sm-12" id="rowChart3">
            <!--Chart 3.1 -->
          </div>
        </div>
        <div class="row">
          <div class="col-sm-9 text-center">
            Ratio Partido / Torneo
          </div>
          <div class="col-sm-3">
            Chart 3.2
          </div>
        </div>
        <div class="row">
          <div class="col-sm-12">
            <hr>
          </div>
        </div>
        <div class="row">
          <div class="col-sm-12">
            Chart 3.3
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

  <script src="./js/jquery.min.js"></script>
  <script src="./js/bootstrap.min.js"></script>
  <!--<script src="./js/dc.js"></script>-->
  <script src="./js/queue.js"></script>
  <script src="./js/keen.min.js"></script>
  <script src='./js/graphs.js' type='text/javascript'></script>
  <script src="http://d3js.org/d3.v3.min.js"></script>
  <script src="http://cdnjs.cloudflare.com/ajax/libs/crossfilter/1.3.7/crossfilter.min.js"></script>
  <script type="text/javascript" src="http://dc-js.github.io/dc.js/js/dc.js"></script>
  <script type="text/javascript">

    'use strict';

    var pieChart  = dc.pieChart("#pieChart");
    var rowChart  = dc.rowChart("#rowChart");
    var pieChart2 = dc.pieChart("#pieChart2");
    var rowChart2 = dc.rowChart("#rowChart2");
    var rowChart3 = dc.rowChart("#rowChart3");

    d3.csv("ZOOMPADEL_WPT_TORNEOS.csv", function(error, experiments) {

      var ndx       = crossfilter(experiments),
      runDimension  = ndx.dimension(function(d) {return d['Tipo Torneo'];}),
      speedSumGroup = runDimension.group().reduce(
          function (p, d) {
            if(d.Torneo in p.Torneos){
                p.Torneos[d.Torneo] += 1
                //console.log(d.Torneo);
            }
            else{
                p.Torneos[d.Torneo] = 1;
                p.id_count++;
            }
            p.count++;
            return p;
        },

        function (p, d) {
            p.Torneos[d.Torneo]--;
            if(p.Torneos[d.Torneo] === 0){
                delete p.Torneos[d.Torneo];
                p.id_count--;
            }
            return p;
        },

        function () {
                return {Torneos: {},
                id_count: 0,
                count: 0};
            }
      );

    pieChart
      .slicesCap(100)
      .innerRadius(60)
      .dimension(runDimension)
      .group(speedSumGroup) 
      .valueAccessor(function (d) {
          return d.value.id_count;
      })
      .renderLabel(false)
      .legend(dc.legend().x(80).y(65).itemHeight(13).gap(5));

    rowChart
    .group(speedSumGroup)
    .dimension(runDimension)
    .margins({top: 0, right: 0, bottom: -1, left: 0})
    .valueAccessor(function (d) {
      return d.value.id_count;
    })
    .elasticX(true)
    .renderLabel(false)
    .xAxis().ticks(0);

    pieChart2
      .slicesCap(100)
      .innerRadius(60)
      .dimension(runDimension)
      .group(speedSumGroup) 
      .valueAccessor(function (d) {
          return d.value.id_count;
      })
      .renderLabel(false)
      .legend(dc.legend().x(80).y(65).itemHeight(13).gap(5));

    rowChart2
    .group(speedSumGroup)
    .dimension(runDimension)
    .margins({top: 0, right: 0, bottom: -1, left: 0})
    .valueAccessor(function (d) {
      return d.value.id_count;
    })
    .elasticX(true)
    .renderLabel(false)
    .xAxis().ticks(0);

    rowChart3
    .group(speedSumGroup)
    .dimension(runDimension)
    .margins({top: 0, right: 0, bottom: -1, left: 0})
    .valueAccessor(function (d) {
      return d.value.id_count;
    })
    .elasticX(true)
    .renderLabel(false)
    .xAxis().ticks(0);
      
    dc.renderAll();
  });
  </script>
</body>
</html>
